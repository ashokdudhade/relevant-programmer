[["Map",1,2,9,10,29,30],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.17.1","content-config-digest","e44bf1a9afa5272b","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://www.relevantprogrammer.com\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"always\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image/\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","pages",["Map",11,12],"about",{"id":11,"data":13,"body":17,"filePath":18,"digest":19,"rendered":20,"legacyId":28},{"title":14,"kind":15,"path":16},"About me","page","/about","I am a Software Engineering Leader specializing in the transition of frontier AI from experimental prototypes to mission-critical, production-grade ecosystems. My work focuses on architecting **Agentic AI**, **Multi-Agent Systems**, and **Model Context Protocol (MCP)** implementations that move beyond simple automation to deliver verifiable business impact and operational efficiency.\r\n\r\nWith a foundation built on **16+ years of distributed systems engineering**, I bridge the gap between complex research and scalable enterprise applications. I lead high-performing organizations by aligning technical roadmaps with executive business goals, fostering a culture of engineering excellence, and ensuring systems are built for long-term observability and security.\r\n\r\n**Core Strategic Focus**\r\n\r\n- **Autonomous Agent Orchestration:** Architecting collaborative AI frameworks where specialized models automate complex, non-linear workflows across customer operations and knowledge management.\r\n\r\n- **Production-Grade RAG & Insight Platforms:** Designing sophisticated Retrieval-Augmented Generation pipelines with rigorous guardrails to transform unstructured enterprise data into actionable intelligence.\r\n\r\n- **Next-Gen Conversational Interfaces:** Engineering low-latency, voice-to-voice, and NLU-driven systems that provide context-aware, human-parity interactions.\r\n\r\n- **Distributed Systems at Scale:** Expert-level experience in building high-throughput, fault-tolerant backends and data pipelines that maintain high availability under massive load.\r\n\r\n**Engineering & Leadership Foundation**\r\n\r\n- **Polyglot Technical Mastery:** Deep proficiency in modern programming languages and frameworks to build unified, maintainable tech stacks from the UI to the data layer.\r\n\r\n- **Cloud Strategy & Infrastructure:** Extensive experience leveraging AWS and cloud-native patterns to build \"well-architected\" solutions that prioritize security, scalability, and cost-optimization.\r\n\r\n- **Organizational Leadership:** A proven track record of hiring and mentoring elite engineering talent, managing multi-functional teams, and driving the technical vision for multi-million dollar digital transformation initiatives.\r\n\r\n\r\nI believe that the value of state-of-the-art technology is measured by its resilience and ROI. Whether implementing a cutting-edge LLM or refactoring a legacy distributed system, my approach is centered on responsible deployment, clear technical debt management, and the delivery of products that solve high-stakes enterprise problems.","src/content/pages/about.md","1505c0d574d29498",{"html":21,"metadata":22},"\u003Cp>I am a Software Engineering Leader specializing in the transition of frontier AI from experimental prototypes to mission-critical, production-grade ecosystems. My work focuses on architecting \u003Cstrong>Agentic AI\u003C/strong>, \u003Cstrong>Multi-Agent Systems\u003C/strong>, and \u003Cstrong>Model Context Protocol (MCP)\u003C/strong> implementations that move beyond simple automation to deliver verifiable business impact and operational efficiency.\u003C/p>\n\u003Cp>With a foundation built on \u003Cstrong>16+ years of distributed systems engineering\u003C/strong>, I bridge the gap between complex research and scalable enterprise applications. I lead high-performing organizations by aligning technical roadmaps with executive business goals, fostering a culture of engineering excellence, and ensuring systems are built for long-term observability and security.\u003C/p>\n\u003Cp>\u003Cstrong>Core Strategic Focus\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Autonomous Agent Orchestration:\u003C/strong> Architecting collaborative AI frameworks where specialized models automate complex, non-linear workflows across customer operations and knowledge management.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Production-Grade RAG &#x26; Insight Platforms:\u003C/strong> Designing sophisticated Retrieval-Augmented Generation pipelines with rigorous guardrails to transform unstructured enterprise data into actionable intelligence.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Next-Gen Conversational Interfaces:\u003C/strong> Engineering low-latency, voice-to-voice, and NLU-driven systems that provide context-aware, human-parity interactions.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Distributed Systems at Scale:\u003C/strong> Expert-level experience in building high-throughput, fault-tolerant backends and data pipelines that maintain high availability under massive load.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Engineering &#x26; Leadership Foundation\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Polyglot Technical Mastery:\u003C/strong> Deep proficiency in modern programming languages and frameworks to build unified, maintainable tech stacks from the UI to the data layer.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Cloud Strategy &#x26; Infrastructure:\u003C/strong> Extensive experience leveraging AWS and cloud-native patterns to build “well-architected” solutions that prioritize security, scalability, and cost-optimization.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Organizational Leadership:\u003C/strong> A proven track record of hiring and mentoring elite engineering talent, managing multi-functional teams, and driving the technical vision for multi-million dollar digital transformation initiatives.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>I believe that the value of state-of-the-art technology is measured by its resilience and ROI. Whether implementing a cutting-edge LLM or refactoring a legacy distributed system, my approach is centered on responsible deployment, clear technical debt management, and the delivery of products that solve high-stakes enterprise problems.\u003C/p>",{"headings":23,"localImagePaths":24,"remoteImagePaths":25,"frontmatter":26,"imagePaths":27},[],[],[],{"title":14,"kind":15,"path":16},[],"about.md","blog",["Map",31,32,61,62,91,92,123,124,172,173],"docker-for-programmers",{"id":31,"data":33,"body":43,"filePath":44,"digest":45,"rendered":46,"legacyId":60},{"title":34,"date":35,"kind":36,"draft":37,"path":38,"category":39,"tags":40,"description":42},"Docker for programmers",["Date","2018-10-06T02:13:55.325Z"],"post",false,"/posts/docker-for-programmers/","Docker",[39,41],"Web Development","This post covers details on using docker to improve the productivity of programmers.","This post covers details on using docker to improve the productivity of programmers.\r\n\r\n## Why should we use docker?\r\n\r\nThere are scenarios where we want to test things quickly without installing dependencies on your developer machine. Docker comes handy in situations like this, its only matter of downloading an image and running it.\r\n\r\nLet's take an example of testing a static website on a local machine. Usually when we develop a web application using react, angular, vuejs etc. webpack is used to the server locally. There would be unfortunate scenarios where actual build would behave differently than the local serving. So to avoid such issue we can test the static website build by running it locally.\r\n\r\nWe have multiple options to do this, such as use nginx, nodejs express etc. Let's take an example of using nginx, it would require nginx installation with a version we want. \r\n\r\n```docker pull nginx:1.15.5```\r\n\r\nAbove command will download nginx 1.15.5 docker image on the local machine.\r\n\r\nTo test static website build.\r\n\r\n```docker run -it -p 3000:80 -v /your-build-dir:/usr/share/nginx/html nginx```\r\n\r\nIt will start nginx inside docker and host machine can access the site on port 3000(http://localhost:3000). \r\n\r\nNow, let's look at another scenario assume we have docker container running on a machine and suddenly it stopped the container. How do we know what happened in the container to stop it?\r\n\r\nFirst thing is to identify the container id, below command should display all containers.\r\n\r\n```\r\ndocker ps -a\r\n```\r\n\r\n* View docker logs\r\n\r\n    ```\r\n    docker logs \u003C\u003CcontainerId>>\r\n    ```\r\n    It's fairly simple to view logs using above command.\r\n\r\n* View log file inside stopped docker container\r\n\r\n    In some cases,```docker logs``` might not be sufficient enough to provide details on exactly what happens. The application might generate logs file at some directory inside the container. If you want to view those logs files from stopped container then we need to copy the file from a stopped container to host machine. Below command could be handy.\r\n\r\n    ```\r\n    docker cp \u003CcontainerId>:/file/path/within/container /host/path/target\r\n\r\n    ```","src/content/blog/docker-for-programmers.md","f62600f7fd17062b",{"html":47,"metadata":48},"\u003Cp>This post covers details on using docker to improve the productivity of programmers.\u003C/p>\n\u003Ch2 id=\"why-should-we-use-docker\">Why should we use docker?\u003C/h2>\n\u003Cp>There are scenarios where we want to test things quickly without installing dependencies on your developer machine. Docker comes handy in situations like this, its only matter of downloading an image and running it.\u003C/p>\n\u003Cp>Let’s take an example of testing a static website on a local machine. Usually when we develop a web application using react, angular, vuejs etc. webpack is used to the server locally. There would be unfortunate scenarios where actual build would behave differently than the local serving. So to avoid such issue we can test the static website build by running it locally.\u003C/p>\n\u003Cp>We have multiple options to do this, such as use nginx, nodejs express etc. Let’s take an example of using nginx, it would require nginx installation with a version we want.\u003C/p>\n\u003Cp>\u003Ccode>docker pull nginx:1.15.5\u003C/code>\u003C/p>\n\u003Cp>Above command will download nginx 1.15.5 docker image on the local machine.\u003C/p>\n\u003Cp>To test static website build.\u003C/p>\n\u003Cp>\u003Ccode>docker run -it -p 3000:80 -v /your-build-dir:/usr/share/nginx/html nginx\u003C/code>\u003C/p>\n\u003Cp>It will start nginx inside docker and host machine can access the site on port 3000(\u003Ca href=\"http://localhost:3000\">http://localhost:3000\u003C/a>).\u003C/p>\n\u003Cp>Now, let’s look at another scenario assume we have docker container running on a machine and suddenly it stopped the container. How do we know what happened in the container to stop it?\u003C/p>\n\u003Cp>First thing is to identify the container id, below command should display all containers.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>docker ps -a\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\n\u003Cp>View docker logs\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>docker logs &#x3C;&#x3C;containerId>>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>It’s fairly simple to view logs using above command.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>View log file inside stopped docker container\u003C/p>\n\u003Cp>In some cases,\u003Ccode>docker logs\u003C/code> might not be sufficient enough to provide details on exactly what happens. The application might generate logs file at some directory inside the container. If you want to view those logs files from stopped container then we need to copy the file from a stopped container to host machine. Below command could be handy.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>docker cp &#x3C;containerId>:/file/path/within/container /host/path/target\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003C/li>\n\u003C/ul>",{"headings":49,"localImagePaths":54,"remoteImagePaths":55,"frontmatter":56,"imagePaths":59},[50],{"depth":51,"slug":52,"text":53},2,"why-should-we-use-docker","Why should we use docker?",[],[],{"title":34,"date":57,"kind":36,"draft":37,"path":38,"category":39,"tags":58,"description":42},"2018-10-06T02:13:55.325Z",[39,41],[],"docker-for-programmers.md","typescript-react-app-with-yarn-worspaces",{"id":61,"data":63,"body":70,"filePath":71,"digest":72,"rendered":73,"legacyId":90},{"title":64,"date":65,"kind":36,"draft":37,"path":66,"category":67,"tags":68,"description":69},"Typescript react app with yarn workspaces",["Date","2018-10-09T02:13:55.325Z"],"/posts/typescript-react-app-with-yarn-worspaces/","React",[67,41],"There are so many posts available for creating react app with yarn workspaces, but I have not came across any article with typescript.","Prerequisites:\r\n* Nodejs\r\n* yarn\r\n* create-react-app\r\n\r\n\r\nThere are so many posts available for creating react app with yarn workspaces, but I have not came across any article with typescript.\r\n\r\nTo create a sample app we will use ```create-react-app``` utility.\r\n\r\n```\r\ncreate-react-app typescript-react-yarn-worspaces --scripts-version=react-scripts-ts\r\n\r\ncd typescript-react-yarn-worspaces\r\n```\r\n\r\n\r\nEject app to unpack all configuration files into our application. This is required to include yarn workspaces directory in typescript configurations.\r\n\r\n```\r\nyarn eject\r\n```\r\n\r\nIt will display a message \"Are you sure you want to eject? This action is permanent.\" Press 'y' to confirm. It should unpack configuration files.\r\n\r\n``\r\n### Why yarn workspaces?\r\n\r\nMultiple reusable packages can be adding in single repository which can depend on each other with single yarn lock file at root directory. This also has benefit of always referring to latest package source code.\r\n\r\n\r\n### Code changes\r\n\r\nOpen new 'typescript-react-yarn-worspaces' directory in your favorite IDE.\r\n\r\nCreate a directory for packages at root level (```typescript-react-yarn-worspaces\\packages```).\r\n\r\nOpen package.json file and add worspaces details.\r\n\r\n```\r\n\"workspaces\": [\"packages/*\"]\r\n```\r\n\r\n\r\nModify webpack configuration to include \"packages\" directory to include for build and watch.\r\n\r\nAdd packagesSrc in paths.js file. (```typescript-react-yarn-worspaces/config/paths.js```)\r\n\r\n![packages source entry](/images/typescript-react-app-with-yarn-worspaces/paths-01.png)\r\n\r\n\r\nModify webpack.config.dev.js to include packages directory.(```typescript-react-yarn-worspaces/config/webpack.config.dev.js```)\r\n\r\n![dev 01](/images/typescript-react-app-with-yarn-worspaces/dev-01.png)\r\n\r\n\r\n![dev 02](/images/typescript-react-app-with-yarn-worspaces/dev-02.png)\r\n\r\n\r\n![dev 03](/images/typescript-react-app-with-yarn-worspaces/dev-03.png)\r\n\r\n\r\n![dev 04](/images/typescript-react-app-with-yarn-worspaces/dev-04.png)\r\n\r\n\r\n\r\n\r\nModify webpack.config.prod.js to include packages directory.(```typescript-react-yarn-worspaces/config/webpack.config.prod.js```)\r\n\r\n![prod 01](/images/typescript-react-app-with-yarn-worspaces/prod-01.png)\r\n![prod 02](/images/typescript-react-app-with-yarn-worspaces/prod-02.png)\r\n![prod 03](/images/typescript-react-app-with-yarn-worspaces/prod-03.png)\r\n\r\n\r\n\r\nNow let's create a reusable ```Header``` component for the application. Create a 'header' directory inside packages(```typescript-react-yarn-worspaces\\packages\\header```) and add below files.\r\n\r\nAdd package.json file(```typescript-react-yarn-worspaces\\packages\\header\\package.json```).\r\n\r\n```\r\n{\r\n    \"name\": \"@my-app/header\",\r\n    \"version\": \"0.1.0\",\r\n    \"private\": true,\r\n    \"dependencies\": {\r\n        \"react\": \"^16.5.2\",\r\n        \"react-dom\": \"^16.5.2\"\r\n    },\r\n    \"devDependencies\": {\r\n        \"@types/node\": \"^10.11.4\",\r\n        \"@types/react\": \"^16.4.16\",\r\n        \"@types/react-dom\": \"^16.0.8\",\r\n        \"typescript\": \"^3.1.1\"\r\n    }\r\n}\r\n```\r\nAdd index.tsx file(```typescript-react-yarn-worspaces\\packages\\header\\index.tsx```).\r\n\r\n```\r\nimport * as React from 'react';\r\n\r\nexport class Header extends React.Component {\r\n  public render() {\r\n    return (\r\n        \u003Cheader className=\"App-header\">\r\n          \u003Ch1 className=\"App-title\">Header from packages\u003C/h1>\r\n        \u003C/header>\r\n    );\r\n  }\r\n}\r\n```\r\n\r\n\r\nModify root package json to add header package dependency along with App.tsx file.\r\n\r\npackage.json dependency\r\n\r\n![package-json](/images/typescript-react-app-with-yarn-worspaces/package-json.png)\r\n\r\nApp.tsx\r\n\r\n```\r\nimport { Header } from '@my-app/header';\r\nimport * as React from 'react';\r\nimport './App.css';\r\n\r\nclass App extends React.Component {\r\n  public render() {\r\n    return (\r\n      \u003Cdiv className=\"App\">\r\n        \u003CHeader/>\r\n        \u003Cp className=\"App-intro\">\r\n          To get started, edit \u003Ccode>src/App.tsx\u003C/code> and save to reload.\r\n        \u003C/p>\r\n      \u003C/div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n```\r\n\r\nTo start app do as below.\r\n\r\n```\r\nyarn install\r\nyarn start\r\n```\r\n\r\nCode is available at [github](https://github.com/ashokdudhade/typescript-react-yarn-worspaces)","src/content/blog/typescript-react-app-with-yarn-worspaces.md","a54bb99c3fd48de0",{"html":74,"metadata":75},"\u003Cp>Prerequisites:\u003C/p>\n\u003Cul>\n\u003Cli>Nodejs\u003C/li>\n\u003Cli>yarn\u003C/li>\n\u003Cli>create-react-app\u003C/li>\n\u003C/ul>\n\u003Cp>There are so many posts available for creating react app with yarn workspaces, but I have not came across any article with typescript.\u003C/p>\n\u003Cp>To create a sample app we will use \u003Ccode>create-react-app\u003C/code> utility.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>create-react-app typescript-react-yarn-worspaces --scripts-version=react-scripts-ts\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>cd typescript-react-yarn-worspaces\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Eject app to unpack all configuration files into our application. This is required to include yarn workspaces directory in typescript configurations.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>yarn eject\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>It will display a message “Are you sure you want to eject? This action is permanent.” Press ‘y’ to confirm. It should unpack configuration files.\u003C/p>\n\u003Cp>“\u003C/p>\n\u003Ch3 id=\"why-yarn-workspaces\">Why yarn workspaces?\u003C/h3>\n\u003Cp>Multiple reusable packages can be adding in single repository which can depend on each other with single yarn lock file at root directory. This also has benefit of always referring to latest package source code.\u003C/p>\n\u003Ch3 id=\"code-changes\">Code changes\u003C/h3>\n\u003Cp>Open new ‘typescript-react-yarn-worspaces’ directory in your favorite IDE.\u003C/p>\n\u003Cp>Create a directory for packages at root level (\u003Ccode>typescript-react-yarn-worspaces\\packages\u003C/code>).\u003C/p>\n\u003Cp>Open package.json file and add worspaces details.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>\"workspaces\": [\"packages/*\"]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Modify webpack configuration to include “packages” directory to include for build and watch.\u003C/p>\n\u003Cp>Add packagesSrc in paths.js file. (\u003Ccode>typescript-react-yarn-worspaces/config/paths.js\u003C/code>)\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/paths-01.png\" alt=\"packages source entry\">\u003C/p>\n\u003Cp>Modify webpack.config.dev.js to include packages directory.(\u003Ccode>typescript-react-yarn-worspaces/config/webpack.config.dev.js\u003C/code>)\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/dev-01.png\" alt=\"dev 01\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/dev-02.png\" alt=\"dev 02\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/dev-03.png\" alt=\"dev 03\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/dev-04.png\" alt=\"dev 04\">\u003C/p>\n\u003Cp>Modify webpack.config.prod.js to include packages directory.(\u003Ccode>typescript-react-yarn-worspaces/config/webpack.config.prod.js\u003C/code>)\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/prod-01.png\" alt=\"prod 01\">\r\n\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/prod-02.png\" alt=\"prod 02\">\r\n\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/prod-03.png\" alt=\"prod 03\">\u003C/p>\n\u003Cp>Now let’s create a reusable \u003Ccode>Header\u003C/code> component for the application. Create a ‘header’ directory inside packages(\u003Ccode>typescript-react-yarn-worspaces\\packages\\header\u003C/code>) and add below files.\u003C/p>\n\u003Cp>Add package.json file(\u003Ccode>typescript-react-yarn-worspaces\\packages\\header\\package.json\u003C/code>).\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \"name\": \"@my-app/header\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \"version\": \"0.1.0\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \"private\": true,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \"dependencies\": {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \"react\": \"^16.5.2\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \"react-dom\": \"^16.5.2\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    },\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \"devDependencies\": {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \"@types/node\": \"^10.11.4\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \"@types/react\": \"^16.4.16\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \"@types/react-dom\": \"^16.0.8\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \"typescript\": \"^3.1.1\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Add index.tsx file(\u003Ccode>typescript-react-yarn-worspaces\\packages\\header\\index.tsx\u003C/code>).\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>import * as React from 'react';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>export class Header extends React.Component {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  public render() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    return (\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;header className=\"App-header\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          &#x3C;h1 className=\"App-title\">Header from packages&#x3C;/h1>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;/header>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Modify root package json to add header package dependency along with App.tsx file.\u003C/p>\n\u003Cp>package.json dependency\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/typescript-react-app-with-yarn-worspaces/package-json.png\" alt=\"package-json\">\u003C/p>\n\u003Cp>App.tsx\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>import { Header } from '@my-app/header';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import * as React from 'react';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import './App.css';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>class App extends React.Component {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  public render() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    return (\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      &#x3C;div className=\"App\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;Header/>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;p className=\"App-intro\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          To get started, edit &#x3C;code>src/App.tsx&#x3C;/code> and save to reload.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;/p>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      &#x3C;/div>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>export default App;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>To start app do as below.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>yarn install\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>yarn start\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Code is available at \u003Ca href=\"https://github.com/ashokdudhade/typescript-react-yarn-worspaces\">github\u003C/a>\u003C/p>",{"headings":76,"localImagePaths":84,"remoteImagePaths":85,"frontmatter":86,"imagePaths":89},[77,81],{"depth":78,"slug":79,"text":80},3,"why-yarn-workspaces","Why yarn workspaces?",{"depth":78,"slug":82,"text":83},"code-changes","Code changes",[],[],{"title":64,"date":87,"kind":36,"draft":37,"path":66,"category":67,"tags":88,"description":69},"2018-10-09T02:13:55.325Z",[67,41],[],"typescript-react-app-with-yarn-worspaces.md","todo-with-react-hooks",{"id":91,"data":93,"body":100,"filePath":101,"digest":102,"rendered":103,"legacyId":122},{"title":94,"date":95,"kind":36,"draft":37,"path":96,"category":67,"tags":97,"description":99},"React hooks app structure",["Date","2019-04-20T02:13:55.325Z"],"/posts/todo-with-react-hooks/",[67,98,41],"React hooks","It a guide to write react hooks application without using recompose or redux dependencies","## Why react hooks?\r\n[React hooks](https://reactjs.org/docs/hooks-intro.html) is a modern way to write the logic in react components without introducing unnecessary nesting of components in the component tree. It simplifies the component structure and makes it easy to read and maintain.\r\n\r\n\r\n## Why not recompose?\r\nRecompose library is the awesome framework which helps write react application using higher order component but unfortunately \r\n[recompose is discontinuing](https://github.com/acdlite/recompose#a-note-from-the-author-acdlite-oct-25-2018) and react hooks is supposed to help to solve problems in a better way.\r\n\r\n## What does this article cover?\r\nA new way of writing react application using react hooks and structure of the app. We will build a standard todo application and structure it to be readable. At the high level below is the structure of the todo app.\r\n\r\n```\r\n└── src\r\n    ├── api\r\n    ├── components\r\n    ├── hooks\r\n    ├── providers\r\n    └── reducers\r\n```\r\nThis structure could be used for any kind of react app.\r\n\r\n* api\r\n\r\n    This directory will have all methods which make calls to an API.\r\n* components\r\n\r\n    This directory consists all react UI components\r\n* hooks\r\n\r\n     This directory has all logic needed for components to handle actions and data passing, manipulations and component lifecycle.\r\n* providers\r\n\r\n    This directory contains all context API providers for react app\r\n* reducers\r\n\r\n    This directory has all reducers which help manages state via actions\r\n\r\n\r\n\r\nLet's start creating Todo app\r\n\r\n```\r\ncreate-react-app todo-with-hooks\r\n```\r\n\r\nCreate an application level store for managing todo items state.\r\n\r\nApp.js\r\n```  \r\nimport React, {useReducer} from 'react';\r\n\r\nconst initialState = {\r\n  todoItems: []\r\n};\r\n\r\nconst store = useReducer(todoReducer, initialState);\r\n```\r\n\r\ntodoReducer.js is reducer function which doesn't have any state in it, its idempotent function. It's the same as a redux reducer, but we are not using redux in this application\r\n```\r\nconst markItemStateChange = (isComplete, id, state) => {\r\n    const item = state.todoItems.find(t => t.id === id);\r\n    if(item){\r\n      item.isComplete = isComplete;\r\n      return {\r\n        ...state, \r\n        todoItems: [...state.todoItems]\r\n      }\r\n    }\r\n    return state;\r\n  }\r\n  \r\n export const todoReducer = (state, action) => {\r\n    switch (action.type) {\r\n      case 'ADD_ITEM':\r\n        return {\r\n          ...state,\r\n          todoItems: [...state.todoItems, \r\n            action.item\r\n          ]\r\n        };\r\n      case 'COMPLETE_ITEM':\r\n        return markItemStateChange(true, action.id, state);\r\n      case 'UNDO_COMPLETE_ITEM':\r\n        return markItemStateChange(false, action.id, state);\r\n      case 'TODO_ITEMS':\r\n        return {\r\n          ...state,\r\n          todoItems: action.todoItems\r\n        }\r\n      default:\r\n        throw new Error('Unexpected action');\r\n    }\r\n  };\r\n  \r\n```\r\nToDo Provider\r\n```\r\nimport React from 'react';\r\n\r\nexport const ToDoContext = React.createContext({});\r\nexport const TodoProvider = ToDoContext.Provider;\r\n```\r\n\r\nNow adding everything together will look like below, we will passing store to the provider we have created.\r\n\r\n```\r\nconst App = () => {\r\n\r\n  const store = useReducer(todoReducer, initialState);\r\n  return (\r\n    \u003Cdiv className=\"App\">\r\n    \u003CTodoProvider value={store}> \r\n      \u003CToDoHome />\r\n    \u003C/TodoProvider>\r\n    \u003C/div>\r\n  );\r\n}\r\n```\r\n\r\nLooking at reducer you might have noticed we will be dealing with 3 operations in this app.\r\n\r\n\r\n1. Fetch todo items\r\n\r\nThis call happen only at once when the application is loaded, it will make API call and set the data in the store.\r\n2. Add todo item\r\n\r\nWhenever a new item is added, it will make an API call, on its success data will be stored in the store.\r\n\r\n3. Complete/undo complete todo item\r\n\r\nWhenever any existing item is marked as complete or not complete, it will call API and set the item in store.\r\n\r\nThe common structure of components is as follows.\r\n\r\nComponents use hooks for logic and state management. Any action in the component will trigger method in hook and based on logic defined it will call an API and update state or do some other action in the app.\r\n\r\nHere is an example of todo item fetching hook. the [useEffect](https://reactjs.org/docs/hooks-effect.html) hook is used here to make API call and it dispatches the action to update todo items. \"useEffect\" is kind of equivalent to withPropsOnChange HoC from recompose in addition it also has behavior of componentDidMount if no prop name is passed. \r\n\r\n\r\n```\r\nimport { useEffect } from \"react\";\r\nimport { fetchTodoItems } from '../api/fetchToDoItems';\r\nimport { useToDoContext } from \"./useTodoContext\";\r\nimport {useCancellablePromise} from '../hooks/useCancellablePromise';\r\n\r\nexport const useToDoList = () => {\r\n    const { state, dispatch } = useToDoContext();\r\n    const { cancellablePromise } = useCancellablePromise();\r\n\r\n    useEffect(() => {\r\n            const fetchItems = async () => {\r\n                const items = await cancellablePromise(fetchTodoItems());\r\n                dispatch({\r\n                        type: 'TODO_ITEMS',\r\n                        todoItems: items\r\n                });\r\n                 \r\n            };\r\n    \r\n            fetchItems();\r\n        \r\n    }, []);\r\n    const { todoItems } = state;\r\n    const openToDoItems = todoItems.filter(t => !t.isComplete);\r\n    const completeToDoItems = todoItems.filter(t => t.isComplete);\r\n\r\n    return {\r\n        todoItems,\r\n        openToDoItems,\r\n        completeToDoItems\r\n    };\r\n}\r\n```\r\n\r\nBecause of all this logic moved to \"useToDoList\" hook, component looks clear and focuses on presentation aspect. It feels like hooks are endorsing to make it more functional. Recompose is also trying to solve same problem, but the nested component tree makes it harder to understand and troubleshoot code.\r\n\r\n```\r\nconst ToDoHome = () => {\r\n    const { todoItems, openToDoItems, completeToDoItems } = useToDoList();\r\n    \r\n\r\n    return (\r\n        \u003CContainer>\r\n            \u003CAddToDo />\r\n            \u003CTodoContainer>\r\n                \u003CTabs defaultActiveKey=\"1\" size={\"large\"}>\r\n                    \u003CTabPane tab={\r\n                        \u003CBadge count={openToDoItems.length} overflowCount={99}>\u003CTabTitle>Open\u003C/TabTitle>\u003C/Badge>\r\n                    } key=\"1\">\r\n                        \u003CToDoItems todoItems={openToDoItems} />\r\n\r\n                    \u003C/TabPane>\r\n                    \u003CTabPane tab={\u003CBadge count={completeToDoItems.length && \u003CCompletedItemBadge>{completeToDoItems.length}\u003C/CompletedItemBadge>} overflowCount={99}>\r\n                        \u003CTabTitle>Completed\u003C/TabTitle>\u003C/Badge>} key=\"2\">\r\n                        \u003CToDoItems todoItems={completeToDoItems} />\r\n\r\n                    \u003C/TabPane>\r\n                    \u003CTabPane tab={\u003CBadge count={todoItems.length && \u003CAllItemsBadge>{todoItems.length}\u003C/AllItemsBadge>} overflowCount={99}>\u003CTabTitle>All\u003C/TabTitle>\u003C/Badge>} key=\"3\">\r\n                        \u003CToDoItems todoItems={todoItems} />\r\n                    \u003C/TabPane>\r\n                \u003C/Tabs>\r\n\r\n            \u003C/TodoContainer>\r\n        \u003C/Container>\r\n    );\r\n}\r\n\r\nexport default ToDoHome;\r\n\r\n```\r\n\r\n\r\n##In conclusion:\r\n\r\nOverall it's bit different than conventional HoC implementation we are used to write using recompose library. I feel its cleaner than recompose implementation. \r\n\r\nApplication Demo:\r\n[https://ashokdudhade.github.io/todo-with-hooks/](https://ashokdudhade.github.io/todo-with-hooks/)\r\n\r\nApplication code is available on github:\r\n[https://github.com/ashokdudhade/todo-with-hooks](https://github.com/ashokdudhade/todo-with-hooks)","src/content/blog/todo-with-react-hooks.md","d14a7606812460e1",{"html":104,"metadata":105},"\u003Ch2 id=\"why-react-hooks\">Why react hooks?\u003C/h2>\n\u003Cp>\u003Ca href=\"https://reactjs.org/docs/hooks-intro.html\">React hooks\u003C/a> is a modern way to write the logic in react components without introducing unnecessary nesting of components in the component tree. It simplifies the component structure and makes it easy to read and maintain.\u003C/p>\n\u003Ch2 id=\"why-not-recompose\">Why not recompose?\u003C/h2>\n\u003Cp>Recompose library is the awesome framework which helps write react application using higher order component but unfortunately\r\n\u003Ca href=\"https://github.com/acdlite/recompose#a-note-from-the-author-acdlite-oct-25-2018\">recompose is discontinuing\u003C/a> and react hooks is supposed to help to solve problems in a better way.\u003C/p>\n\u003Ch2 id=\"what-does-this-article-cover\">What does this article cover?\u003C/h2>\n\u003Cp>A new way of writing react application using react hooks and structure of the app. We will build a standard todo application and structure it to be readable. At the high level below is the structure of the todo app.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>└── src\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    ├── api\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    ├── components\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    ├── hooks\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    ├── providers\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    └── reducers\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This structure could be used for any kind of react app.\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>api\u003C/p>\n\u003Cp>This directory will have all methods which make calls to an API.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>components\u003C/p>\n\u003Cp>This directory consists all react UI components\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>hooks\u003C/p>\n\u003Cp>This directory has all logic needed for components to handle actions and data passing, manipulations and component lifecycle.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>providers\u003C/p>\n\u003Cp>This directory contains all context API providers for react app\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>reducers\u003C/p>\n\u003Cp>This directory has all reducers which help manages state via actions\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>Let’s start creating Todo app\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>create-react-app todo-with-hooks\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Create an application level store for managing todo items state.\u003C/p>\n\u003Cp>App.js\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>import React, {useReducer} from 'react';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>const initialState = {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  todoItems: []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>const store = useReducer(todoReducer, initialState);\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>todoReducer.js is reducer function which doesn’t have any state in it, its idempotent function. It’s the same as a redux reducer, but we are not using redux in this application\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>const markItemStateChange = (isComplete, id, state) => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const item = state.todoItems.find(t => t.id === id);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    if(item){\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      item.isComplete = isComplete;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      return {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        ...state, \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        todoItems: [...state.todoItems]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    return state;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> export const todoReducer = (state, action) => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    switch (action.type) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      case 'ADD_ITEM':\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        return {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          ...state,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          todoItems: [...state.todoItems, \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            action.item\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          ]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      case 'COMPLETE_ITEM':\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        return markItemStateChange(true, action.id, state);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      case 'UNDO_COMPLETE_ITEM':\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        return markItemStateChange(false, action.id, state);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      case 'TODO_ITEMS':\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        return {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          ...state,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          todoItems: action.todoItems\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      default:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        throw new Error('Unexpected action');\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>ToDo Provider\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>import React from 'react';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>export const ToDoContext = React.createContext({});\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>export const TodoProvider = ToDoContext.Provider;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Now adding everything together will look like below, we will passing store to the provider we have created.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>const App = () => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  const store = useReducer(todoReducer, initialState);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  return (\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    &#x3C;div className=\"App\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    &#x3C;TodoProvider value={store}> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      &#x3C;ToDoHome />\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    &#x3C;/TodoProvider>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    &#x3C;/div>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Looking at reducer you might have noticed we will be dealing with 3 operations in this app.\u003C/p>\n\u003Col>\n\u003Cli>Fetch todo items\u003C/li>\n\u003C/ol>\n\u003Cp>This call happen only at once when the application is loaded, it will make API call and set the data in the store.\r\n2. Add todo item\u003C/p>\n\u003Cp>Whenever a new item is added, it will make an API call, on its success data will be stored in the store.\u003C/p>\n\u003Col start=\"3\">\n\u003Cli>Complete/undo complete todo item\u003C/li>\n\u003C/ol>\n\u003Cp>Whenever any existing item is marked as complete or not complete, it will call API and set the item in store.\u003C/p>\n\u003Cp>The common structure of components is as follows.\u003C/p>\n\u003Cp>Components use hooks for logic and state management. Any action in the component will trigger method in hook and based on logic defined it will call an API and update state or do some other action in the app.\u003C/p>\n\u003Cp>Here is an example of todo item fetching hook. the \u003Ca href=\"https://reactjs.org/docs/hooks-effect.html\">useEffect\u003C/a> hook is used here to make API call and it dispatches the action to update todo items. “useEffect” is kind of equivalent to withPropsOnChange HoC from recompose in addition it also has behavior of componentDidMount if no prop name is passed.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>import { useEffect } from \"react\";\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import { fetchTodoItems } from '../api/fetchToDoItems';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import { useToDoContext } from \"./useTodoContext\";\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import {useCancellablePromise} from '../hooks/useCancellablePromise';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>export const useToDoList = () => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const { state, dispatch } = useToDoContext();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const { cancellablePromise } = useCancellablePromise();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    useEffect(() => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            const fetchItems = async () => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                const items = await cancellablePromise(fetchTodoItems());\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                dispatch({\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        type: 'TODO_ITEMS',\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        todoItems: items\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                });\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                 \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            fetchItems();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }, []);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const { todoItems } = state;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const openToDoItems = todoItems.filter(t => !t.isComplete);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const completeToDoItems = todoItems.filter(t => t.isComplete);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    return {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        todoItems,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        openToDoItems,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        completeToDoItems\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Because of all this logic moved to “useToDoList” hook, component looks clear and focuses on presentation aspect. It feels like hooks are endorsing to make it more functional. Recompose is also trying to solve same problem, but the nested component tree makes it harder to understand and troubleshoot code.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>const ToDoHome = () => {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    const { todoItems, openToDoItems, completeToDoItems } = useToDoList();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    return (\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;Container>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            &#x3C;AddToDo />\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            &#x3C;TodoContainer>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                &#x3C;Tabs defaultActiveKey=\"1\" size={\"large\"}>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    &#x3C;TabPane tab={\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        &#x3C;Badge count={openToDoItems.length} overflowCount={99}>&#x3C;TabTitle>Open&#x3C;/TabTitle>&#x3C;/Badge>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    } key=\"1\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        &#x3C;ToDoItems todoItems={openToDoItems} />\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    &#x3C;/TabPane>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    &#x3C;TabPane tab={&#x3C;Badge count={completeToDoItems.length &#x26;&#x26; &#x3C;CompletedItemBadge>{completeToDoItems.length}&#x3C;/CompletedItemBadge>} overflowCount={99}>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        &#x3C;TabTitle>Completed&#x3C;/TabTitle>&#x3C;/Badge>} key=\"2\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        &#x3C;ToDoItems todoItems={completeToDoItems} />\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    &#x3C;/TabPane>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    &#x3C;TabPane tab={&#x3C;Badge count={todoItems.length &#x26;&#x26; &#x3C;AllItemsBadge>{todoItems.length}&#x3C;/AllItemsBadge>} overflowCount={99}>&#x3C;TabTitle>All&#x3C;/TabTitle>&#x3C;/Badge>} key=\"3\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                        &#x3C;ToDoItems todoItems={todoItems} />\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                    &#x3C;/TabPane>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                &#x3C;/Tabs>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            &#x3C;/TodoContainer>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;/Container>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>export default ToDoHome;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>##In conclusion:\u003C/p>\n\u003Cp>Overall it’s bit different than conventional HoC implementation we are used to write using recompose library. I feel its cleaner than recompose implementation.\u003C/p>\n\u003Cp>Application Demo:\r\n\u003Ca href=\"https://ashokdudhade.github.io/todo-with-hooks/\">https://ashokdudhade.github.io/todo-with-hooks/\u003C/a>\u003C/p>\n\u003Cp>Application code is available on github:\r\n\u003Ca href=\"https://github.com/ashokdudhade/todo-with-hooks\">https://github.com/ashokdudhade/todo-with-hooks\u003C/a>\u003C/p>",{"headings":106,"localImagePaths":116,"remoteImagePaths":117,"frontmatter":118,"imagePaths":121},[107,110,113],{"depth":51,"slug":108,"text":109},"why-react-hooks","Why react hooks?",{"depth":51,"slug":111,"text":112},"why-not-recompose","Why not recompose?",{"depth":51,"slug":114,"text":115},"what-does-this-article-cover","What does this article cover?",[],[],{"title":94,"date":119,"kind":36,"draft":37,"path":96,"category":67,"tags":120,"description":99},"2019-04-20T02:13:55.325Z",[67,98,41],[],"todo-with-react-hooks.md","how-to-build-api-in-kotline-using-ktor",{"id":123,"data":125,"body":134,"filePath":135,"digest":136,"rendered":137,"legacyId":171},{"title":126,"date":127,"kind":36,"draft":37,"path":128,"category":129,"tags":130,"description":133},"How to build API in kotlin using ktor framework",["Date","2020-02-21T02:13:55.325Z"],"/posts/how-to-build-api-in-kotline-using-ktor/","kotlin",[129,131,132],"ktor","API","Guide to build api in kotlin using ktor framework","## Why ktor?\r\n[Ktor](https://ktor.io/) Framework doesn't impose a lot of constraints on what technology a project is going to use logging, templating, messaging, persistent, serializing, dependency injection, etc. Ktor pipeline and API is utilising Kotlin coroutines to provide. All host implementations are using asynchronous I/O facilities to avoid thread blocking.\r\n\r\n## What does this post cover?\r\n* How to build api?\r\n* Dependency injection?\r\n* Logging?\r\n* Unit testing?\r\n\r\n## Application structure\r\nThis post demonstrates TODO api creation using ktor framework.\r\n\r\n\r\n\r\n    ├── build.gradle\r\n    ├── resources\r\n    │   ├── application.conf\r\n    │   └── logback.xml\r\n    ├── settings.gradle\r\n    ├── src\r\n    │   ├── Application.kt\r\n    │   ├── dao\r\n    │   │   ├── DAOFacade.kt\r\n    │   │   ├── Todos.kt\r\n    │   │   └── implementation\r\n    │   │       └── DAOFacadeDatabase.kt\r\n    │   ├── entities\r\n    │   │   └── Todo.kt\r\n    │   ├── routes\r\n    │   │   └── TodoRoutes.kt\r\n    │   └── service\r\n    │       └── TodoService.kt\r\n    └── test\r\n        └── service\r\n            └── TodoServiceTests.kt\r\n\r\n\r\n\r\n\r\n* `resources/application.conf` - This file contains configuration information for the api, it uses HACON format. More details on configuration can be found [here](https://ktor.io/servers/configuration.html)\r\n\r\n* `resources/logback.xml` - This file has logback configuration for generating application logs\r\n\r\n* `src/Application.kt` - Application bootstrap method\r\n\r\n* `src/entities/Todo.kt` - Entity used for Todo data\r\n\r\n* `src/routes/TodoRoutes.kt` - This file contains all routes related to todo api\r\n\r\n* `src/service/TodoService` - This file acts as proxy for now, it would be place add business logic related to specific api call\r\n\r\n* `src/dao/implementation/DAOFacadeDatabase` - In memory h2 database store for storing todo data.\r\n\r\n\r\nThis structure will help manage application as it grows, clear separation of application logic from routes makes it easy to understand and maintain application.\r\n\r\n\r\n## How to build simple api?\r\n\r\nCreating a route and exposing it as http endpoint is done via adding `routing` method inside application call with api path + http method.\r\n\r\nExample:\r\n\r\nBelow example exposes endpoint /health and will return \"UP\" \r\n```\r\n    routing {\r\n        get(\"/health\") {\r\n            //Send response to calling client\r\n            call.respond(\"UP\")\r\n        }\r\n    }\r\n```\r\n\r\nBelow example exposes endpoint /todo to post a todo item to the api and read request body, process it and return response\r\n\r\n```\r\nrouting{\r\n    post(\"/todo\") {\r\n        //Read request body and convert it into entity Todo\r\n        val todo = call.receive\u003CTodo>()\r\n        val resoponse = processTodo(todo)\r\n        //Send response to calling client\r\n        call.respond(response)\r\n    }\r\n}\r\n\r\n```\r\n\r\n## What frameworks are used in this example?\r\n\r\nBelow are few library/frameworks we will be using for building this API.\r\n\r\n* h2 database - for in-memory database\r\n* logback - for application logging\r\n* guice - for dependency injection\r\n* jetbrains.exposed - for querying database\r\n* mockk - for mocking while unit testing\r\n\r\n## How to setup dependency injection using guice?\r\n\r\nBind application instance to Application class and Todo classes. \r\n\r\n```\r\nclass MainModule(private val application: Application) : AbstractModule() {\r\n    override fun configure() {\r\n        bind(Application::class.java).toInstance(application)\r\n    }\r\n}\r\n\r\nclass TodoModule() : AbstractModule() {\r\n    override fun configure() {\r\n        bind(TodoRoutes::class.java).asEagerSingleton()\r\n\r\n        val dir = File(\"build/db\")\r\n\r\n\r\n        val pool = ComboPooledDataSource().apply {\r\n            driverClass = Driver::class.java.name\r\n            jdbcUrl = \"jdbc:h2:file:${dir.canonicalFile.absolutePath}\"\r\n            user = \"\"\r\n            password = \"\"\r\n        }\r\n\r\n\r\n        val dao: DAOFacade =\r\n            DAOFacadeDatabase(Database.connect(pool))\r\n        dao.init()\r\n        bind(TodoService::class.java).asEagerSingleton()\r\n        bind(DAOFacade::class.java).toInstance(dao)\r\n    }\r\n}\r\n```\r\n\r\nThen configure these module to be used in program\r\n\r\n```\r\nGuice.createInjector(MainModule(this), TodoModule())\r\n```\r\n\r\n## How to install features to the pipeline?\r\nInstall ContentNegotiation to setup json response support.\r\n\r\n```\r\n    install(ContentNegotiation) {\r\n        register(ContentType.Application.Json, GsonConverter())\r\n    }\r\n```\r\nInstall CallLogging - This will enable call logging\r\n```\r\n    install(CallLogging) {\r\n    }\r\n```\r\n\r\nAdvance call logging for logging context - This would add correlationId and requestId on each api call and add it to MDC. MDC properties will be added to each log message that gets executed for http request. \r\n\r\n```\r\n    val correlationId = \"x-client-request-id\"\r\n    install(CallLogging) {\r\n        mdc(correlationId) {\r\n            it.request.headers[correlationId]\r\n        }\r\n        mdc(\"requestId\") {\r\n            UUID.randomUUID().toString()\r\n        }\r\n    }\r\n```\r\n\r\n\r\n\r\nIf logback is using JSON layout automatically all MDC properties are added in log. If using pattern layout you can specify the MDC property to be added in pattern by using `%X{correlationId}` format.\r\n\r\nExample for pattern layout\r\n\r\n```\r\n\r\n\u003Cappender name=\"CONSOLE\" class=\"ch.qos.logback.core.ConsoleAppender\">\r\n        \u003Clayout class=\"ch.qos.logback.classic.PatternLayout\">\r\n            \u003CPattern>\r\n                %d{HH:mm:ss.SSS} %X{correlationId} %X{requestId} [%t] %-5level %logger{36} - %msg%n\r\n            \u003C/Pattern>\r\n        \u003C/layout>\r\n    \u003C/appender>\r\n\r\n```\r\n\r\n\r\n## How to do unit tests?\r\n\r\nHere is example of service unit test by mocking DAO call.\r\n\r\n```\r\nimport com.relevant.programmer.dao.DAOFacade\r\nimport com.relevant.programmer.entities.Todo\r\nimport io.mockk.every\r\nimport io.mockk.mockk\r\nimport io.mockk.verify\r\nimport org.junit.Test\r\nimport kotlin.test.assertEquals\r\n\r\nclass TodoServiceTests {\r\n    @Test\r\n    fun getAllTodosTest(){\r\n        val todo = Todo(text = \"test todo\")\r\n        val dao = mockk\u003CDAOFacade>()\r\n        val testUser = \"testUser\"\r\n        every { dao.findAllTodos(testUser) } returns listOf(todo)\r\n        val service = TodoService(dao)\r\n        val todos = service.getAllTodos(testUser)\r\n        assertEquals(todos, listOf(todo))\r\n        verify { dao.findAllTodos(testUser) }\r\n\r\n    }\r\n}\r\n```\r\n\r\nTodo api example is available [here](https://github.com/ashokdudhade/ktor-todo) in github repo.","src/content/blog/how-to-build-api-in-kotline-using-ktor.md","ee2c3dea806dc0f9",{"html":138,"metadata":139},"\u003Ch2 id=\"why-ktor\">Why ktor?\u003C/h2>\n\u003Cp>\u003Ca href=\"https://ktor.io/\">Ktor\u003C/a> Framework doesn’t impose a lot of constraints on what technology a project is going to use logging, templating, messaging, persistent, serializing, dependency injection, etc. Ktor pipeline and API is utilising Kotlin coroutines to provide. All host implementations are using asynchronous I/O facilities to avoid thread blocking.\u003C/p>\n\u003Ch2 id=\"what-does-this-post-cover\">What does this post cover?\u003C/h2>\n\u003Cul>\n\u003Cli>How to build api?\u003C/li>\n\u003Cli>Dependency injection?\u003C/li>\n\u003Cli>Logging?\u003C/li>\n\u003Cli>Unit testing?\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"application-structure\">Application structure\u003C/h2>\n\u003Cp>This post demonstrates TODO api creation using ktor framework.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>├── build.gradle\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>├── resources\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   ├── application.conf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   └── logback.xml\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>├── settings.gradle\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>├── src\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   ├── Application.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   ├── dao\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   │   ├── DAOFacade.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   │   ├── Todos.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   │   └── implementation\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   │       └── DAOFacadeDatabase.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   ├── entities\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   │   └── Todo.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   ├── routes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   │   └── TodoRoutes.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│   └── service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│       └── TodoService.kt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>└── test\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    └── service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        └── TodoServiceTests.kt\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Ccode>resources/application.conf\u003C/code> - This file contains configuration information for the api, it uses HACON format. More details on configuration can be found \u003Ca href=\"https://ktor.io/servers/configuration.html\">here\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>resources/logback.xml\u003C/code> - This file has logback configuration for generating application logs\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>src/Application.kt\u003C/code> - Application bootstrap method\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>src/entities/Todo.kt\u003C/code> - Entity used for Todo data\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>src/routes/TodoRoutes.kt\u003C/code> - This file contains all routes related to todo api\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>src/service/TodoService\u003C/code> - This file acts as proxy for now, it would be place add business logic related to specific api call\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>src/dao/implementation/DAOFacadeDatabase\u003C/code> - In memory h2 database store for storing todo data.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>This structure will help manage application as it grows, clear separation of application logic from routes makes it easy to understand and maintain application.\u003C/p>\n\u003Ch2 id=\"how-to-build-simple-api\">How to build simple api?\u003C/h2>\n\u003Cp>Creating a route and exposing it as http endpoint is done via adding \u003Ccode>routing\u003C/code> method inside application call with api path + http method.\u003C/p>\n\u003Cp>Example:\u003C/p>\n\u003Cp>Below example exposes endpoint /health and will return “UP”\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    routing {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        get(\"/health\") {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            //Send response to calling client\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            call.respond(\"UP\")\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Below example exposes endpoint /todo to post a todo item to the api and read request body, process it and return response\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>routing{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    post(\"/todo\") {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        //Read request body and convert it into entity Todo\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val todo = call.receive&#x3C;Todo>()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val resoponse = processTodo(todo)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        //Send response to calling client\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        call.respond(response)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"what-frameworks-are-used-in-this-example\">What frameworks are used in this example?\u003C/h2>\n\u003Cp>Below are few library/frameworks we will be using for building this API.\u003C/p>\n\u003Cul>\n\u003Cli>h2 database - for in-memory database\u003C/li>\n\u003Cli>logback - for application logging\u003C/li>\n\u003Cli>guice - for dependency injection\u003C/li>\n\u003Cli>jetbrains.exposed - for querying database\u003C/li>\n\u003Cli>mockk - for mocking while unit testing\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"how-to-setup-dependency-injection-using-guice\">How to setup dependency injection using guice?\u003C/h2>\n\u003Cp>Bind application instance to Application class and Todo classes.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>class MainModule(private val application: Application) : AbstractModule() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    override fun configure() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        bind(Application::class.java).toInstance(application)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>class TodoModule() : AbstractModule() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    override fun configure() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        bind(TodoRoutes::class.java).asEagerSingleton()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val dir = File(\"build/db\")\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val pool = ComboPooledDataSource().apply {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            driverClass = Driver::class.java.name\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            jdbcUrl = \"jdbc:h2:file:${dir.canonicalFile.absolutePath}\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            user = \"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            password = \"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val dao: DAOFacade =\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            DAOFacadeDatabase(Database.connect(pool))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        dao.init()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        bind(TodoService::class.java).asEagerSingleton()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        bind(DAOFacade::class.java).toInstance(dao)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Then configure these module to be used in program\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Guice.createInjector(MainModule(this), TodoModule())\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"how-to-install-features-to-the-pipeline\">How to install features to the pipeline?\u003C/h2>\n\u003Cp>Install ContentNegotiation to setup json response support.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    install(ContentNegotiation) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        register(ContentType.Application.Json, GsonConverter())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Install CallLogging - This will enable call logging\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    install(CallLogging) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Advance call logging for logging context - This would add correlationId and requestId on each api call and add it to MDC. MDC properties will be added to each log message that gets executed for http request.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    val correlationId = \"x-client-request-id\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    install(CallLogging) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        mdc(correlationId) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            it.request.headers[correlationId]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        mdc(\"requestId\") {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            UUID.randomUUID().toString()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>If logback is using JSON layout automatically all MDC properties are added in log. If using pattern layout you can specify the MDC property to be added in pattern by using \u003Ccode>%X{correlationId}\u003C/code> format.\u003C/p>\n\u003Cp>Example for pattern layout\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;appender name=\"CONSOLE\" class=\"ch.qos.logback.core.ConsoleAppender\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;layout class=\"ch.qos.logback.classic.PatternLayout\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            &#x3C;Pattern>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                %d{HH:mm:ss.SSS} %X{correlationId} %X{requestId} [%t] %-5level %logger{36} - %msg%n\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>            &#x3C;/Pattern>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        &#x3C;/layout>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    &#x3C;/appender>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"how-to-do-unit-tests\">How to do unit tests?\u003C/h2>\n\u003Cp>Here is example of service unit test by mocking DAO call.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>import com.relevant.programmer.dao.DAOFacade\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import com.relevant.programmer.entities.Todo\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import io.mockk.every\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import io.mockk.mockk\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import io.mockk.verify\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import org.junit.Test\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>import kotlin.test.assertEquals\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>class TodoServiceTests {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    @Test\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    fun getAllTodosTest(){\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val todo = Todo(text = \"test todo\")\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val dao = mockk&#x3C;DAOFacade>()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val testUser = \"testUser\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        every { dao.findAllTodos(testUser) } returns listOf(todo)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val service = TodoService(dao)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        val todos = service.getAllTodos(testUser)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        assertEquals(todos, listOf(todo))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>        verify { dao.findAllTodos(testUser) }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Todo api example is available \u003Ca href=\"https://github.com/ashokdudhade/ktor-todo\">here\u003C/a> in github repo.\u003C/p>",{"headings":140,"localImagePaths":165,"remoteImagePaths":166,"frontmatter":167,"imagePaths":170},[141,144,147,150,153,156,159,162],{"depth":51,"slug":142,"text":143},"why-ktor","Why ktor?",{"depth":51,"slug":145,"text":146},"what-does-this-post-cover","What does this post cover?",{"depth":51,"slug":148,"text":149},"application-structure","Application structure",{"depth":51,"slug":151,"text":152},"how-to-build-simple-api","How to build simple api?",{"depth":51,"slug":154,"text":155},"what-frameworks-are-used-in-this-example","What frameworks are used in this example?",{"depth":51,"slug":157,"text":158},"how-to-setup-dependency-injection-using-guice","How to setup dependency injection using guice?",{"depth":51,"slug":160,"text":161},"how-to-install-features-to-the-pipeline","How to install features to the pipeline?",{"depth":51,"slug":163,"text":164},"how-to-do-unit-tests","How to do unit tests?",[],[],{"title":126,"date":168,"kind":36,"draft":37,"path":128,"category":129,"tags":169,"description":133},"2020-02-21T02:13:55.325Z",[129,131,132],[],"how-to-build-api-in-kotline-using-ktor.md","how-use-git-bisect",{"id":172,"data":174,"body":182,"filePath":183,"digest":184,"rendered":185,"legacyId":204},{"title":175,"date":176,"kind":36,"draft":37,"path":177,"category":178,"tags":179,"description":181},"How to use git bisect?",["Date","2020-07-25T02:13:55.325Z"],"/posts/how-use-git-bisect/","git",[178,180],"tools","Guide to use git bisect to identify bug introduced commits","## What is git bisect?\r\n`git-bisect - Use binary search to find the commit that introduced a bug`\r\n\r\n\r\n## Why git bisect?\r\nAs software engineers we work on complex systems on day to day basis, unintentionally we introduce bugs which will get noticed in later time. `git-bisect` will help you efficiently find that commit with bug introduction.\r\n\r\nIf you notice a bug in application with huge commit history which was introduced in past but the exact commit sha or time is not known, then git bisect is the tool can save your time.\r\n\r\n\r\n## How to use bisect?\r\n* Checkout master branch and pull latest code from upstream repo\r\n* Find the commit history which had working and checkout it. `git checkout \u003C\u003Csha>>`\r\n* Run your code and verify that bug doesn't exists\r\n* Run `git bisect start` to initiate bisect\r\n* Run `git bisect good` to mark this commit as good\r\n* Run `git checkout master`\r\n* Run `git bisect bad` to mark latest code as bad commit.\r\n* It will automatically checkout commit sha which is calculated using binary search(Usually this sha would be middle of master to working commit.)\r\n* Run your code again if bug exists mark bisect as good or else mark as bad. `git bisect good` (if not bug) or `git bisect bad` (If bug exists)\r\n* Continue this process till bisect tells your offending commit, and thats the place which introduced the bug.\r\n* Once you found the place where bug was introduced, then you can conclude the bisect using `git bisect reset`\r\n\r\nExample: \r\n\r\nLet say we have git repo which has 10 commits, we don't know what commit caused the bug but we know bug was not there in initial commit. So we will start bisect with latest commit and initial commit. \r\n\r\nAlso lets assume that bug was introduced when export call return \"Export commit 3\"\r\n```\r\n➜ python index.py --export /test\r\nExport commit 3\r\n```\r\n\r\nClone test repo on your local\r\n```\r\ngit clone https://github.com/ashokdudhade/git-bisect-demo.git\r\n```\r\n\r\nAll commits:\r\n\r\n```\r\ngit log --oneline\r\n```\r\n\r\n![Commits](/images/how-use-git-bisect/01_commits.png)\r\n\r\n\r\nCheckout the branch where we know commit is good\r\n\r\n```\r\ngit checkout 06c5c14\r\n```\r\n\r\nStart the bisect\r\n```\r\ngit bisect start\r\n```\r\n\r\nMake sure the application is working state\r\n```\r\n➜  git-bisect-demo git:(06c5c14) python index.py -e l\r\nExport initial\r\n```\r\n\r\nMark the commit as good\r\n```\r\ngit bisect good\r\n```\r\n\r\nCheckout master \r\n```git checkout master```\r\n\r\nMark the master as bad commit as we know it has bug\r\n```git bisect bad```\r\n\r\nIt would output something like below and it will checkout next commit\r\n![Bisect bad](/images/how-use-git-bisect/02_bisect_bad.png)\r\n\r\n\r\nRun the application to see if bug is there\r\n```\r\n➜  git-bisect-demo git:(65aee15) python index.py -e l\r\nExport commit 4\r\n\r\n```\r\n\r\nMark this as bad commit because \"Export commit 4\" displayed and we expect \"Export commit 3\"\r\n```\r\ngit bisect bad\r\n```\r\n\r\n![Bisect bad](/images/how-use-git-bisect/03_bisect_bad.png)\r\n\r\n\r\nRun the application to see if bug is there\r\n```\r\n➜  git-bisect-demo git:(5f8210c) python index.py -e l\r\nExport commit 3\r\n```\r\n\r\nThis is the message we are expecting so we will mark it as good\r\n\r\n```\r\ngit bisect good\r\n```\r\n![Bisect good](/images/how-use-git-bisect/04_bisect_good.png)\r\n\r\n\r\nRun the application to see if bug is there\r\n```\r\n➜  git-bisect-demo git:(2754957) python index.py -e l\r\nExport commit 3\r\n\r\n```\r\nThis is the message we are expecting so we will mark it as good\r\n\r\n```\r\ngit bisect good\r\n```\r\n\r\n```\r\n➜  git-bisect-demo git:(2754957) git bisect good\r\n65aee158c45ac1d901293b413aa3efe89aea262e is the first bad commit\r\ncommit 65aee158c45ac1d901293b413aa3efe89aea262e\r\nAuthor: \r\nDate:   Sat Jul 25 08:04:57 2020 -0500\r\n\r\n    5th commit\r\n\r\n:100644 100644 5a6e0ca2db884e650af657f600586661caa6d236 fa9cd39e2fe3d84dff6f0026cf6➜\r\n```\r\n\r\nThis is the commit which introduced the bug, now we can go and fix it at proper location.\r\n\r\nConclude the bisect\r\n\r\n```\r\ngit bisect reset\r\n```\r\n\r\nThis will bring back to initial checkout, now you can checkout master and fix the issue.\r\n\r\nThis is how commits our picked for bisect\r\n\r\n![Bisect ](/images/how-use-git-bisect/05_git_bisect.png)\r\n\r\n\r\nThere are advanced ways to do similar activity, this article considers you are new to git bisect and provide beginners approach. This technique is pretty useful when large number of commits in your branch. \r\n\r\nDemo git repo is available here: https://github.com/ashokdudhade/git-bisect-demo","src/content/blog/how-use-git-bisect.md","01f727c0df426903",{"html":186,"metadata":187},"\u003Ch2 id=\"what-is-git-bisect\">What is git bisect?\u003C/h2>\n\u003Cp>\u003Ccode>git-bisect - Use binary search to find the commit that introduced a bug\u003C/code>\u003C/p>\n\u003Ch2 id=\"why-git-bisect\">Why git bisect?\u003C/h2>\n\u003Cp>As software engineers we work on complex systems on day to day basis, unintentionally we introduce bugs which will get noticed in later time. \u003Ccode>git-bisect\u003C/code> will help you efficiently find that commit with bug introduction.\u003C/p>\n\u003Cp>If you notice a bug in application with huge commit history which was introduced in past but the exact commit sha or time is not known, then git bisect is the tool can save your time.\u003C/p>\n\u003Ch2 id=\"how-to-use-bisect\">How to use bisect?\u003C/h2>\n\u003Cul>\n\u003Cli>Checkout master branch and pull latest code from upstream repo\u003C/li>\n\u003Cli>Find the commit history which had working and checkout it. \u003Ccode>git checkout &#x3C;&#x3C;sha>>\u003C/code>\u003C/li>\n\u003Cli>Run your code and verify that bug doesn’t exists\u003C/li>\n\u003Cli>Run \u003Ccode>git bisect start\u003C/code> to initiate bisect\u003C/li>\n\u003Cli>Run \u003Ccode>git bisect good\u003C/code> to mark this commit as good\u003C/li>\n\u003Cli>Run \u003Ccode>git checkout master\u003C/code>\u003C/li>\n\u003Cli>Run \u003Ccode>git bisect bad\u003C/code> to mark latest code as bad commit.\u003C/li>\n\u003Cli>It will automatically checkout commit sha which is calculated using binary search(Usually this sha would be middle of master to working commit.)\u003C/li>\n\u003Cli>Run your code again if bug exists mark bisect as good or else mark as bad. \u003Ccode>git bisect good\u003C/code> (if not bug) or \u003Ccode>git bisect bad\u003C/code> (If bug exists)\u003C/li>\n\u003Cli>Continue this process till bisect tells your offending commit, and thats the place which introduced the bug.\u003C/li>\n\u003Cli>Once you found the place where bug was introduced, then you can conclude the bisect using \u003Ccode>git bisect reset\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cp>Example:\u003C/p>\n\u003Cp>Let say we have git repo which has 10 commits, we don’t know what commit caused the bug but we know bug was not there in initial commit. So we will start bisect with latest commit and initial commit.\u003C/p>\n\u003Cp>Also lets assume that bug was introduced when export call return “Export commit 3”\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>➜ python index.py --export /test\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Export commit 3\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Clone test repo on your local\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git clone https://github.com/ashokdudhade/git-bisect-demo.git\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>All commits:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git log --oneline\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/how-use-git-bisect/01_commits.png\" alt=\"Commits\">\u003C/p>\n\u003Cp>Checkout the branch where we know commit is good\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git checkout 06c5c14\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Start the bisect\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git bisect start\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Make sure the application is working state\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>➜  git-bisect-demo git:(06c5c14) python index.py -e l\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Export initial\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Mark the commit as good\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git bisect good\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Checkout master\r\n\u003Ccode>git checkout master\u003C/code>\u003C/p>\n\u003Cp>Mark the master as bad commit as we know it has bug\r\n\u003Ccode>git bisect bad\u003C/code>\u003C/p>\n\u003Cp>It would output something like below and it will checkout next commit\r\n\u003Cimg src=\"/images/how-use-git-bisect/02_bisect_bad.png\" alt=\"Bisect bad\">\u003C/p>\n\u003Cp>Run the application to see if bug is there\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>➜  git-bisect-demo git:(65aee15) python index.py -e l\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Export commit 4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Mark this as bad commit because “Export commit 4” displayed and we expect “Export commit 3”\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git bisect bad\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/how-use-git-bisect/03_bisect_bad.png\" alt=\"Bisect bad\">\u003C/p>\n\u003Cp>Run the application to see if bug is there\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>➜  git-bisect-demo git:(5f8210c) python index.py -e l\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Export commit 3\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is the message we are expecting so we will mark it as good\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git bisect good\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/how-use-git-bisect/04_bisect_good.png\" alt=\"Bisect good\">\u003C/p>\n\u003Cp>Run the application to see if bug is there\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>➜  git-bisect-demo git:(2754957) python index.py -e l\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Export commit 3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is the message we are expecting so we will mark it as good\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git bisect good\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>➜  git-bisect-demo git:(2754957) git bisect good\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>65aee158c45ac1d901293b413aa3efe89aea262e is the first bad commit\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>commit 65aee158c45ac1d901293b413aa3efe89aea262e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Author: \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Date:   Sat Jul 25 08:04:57 2020 -0500\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    5th commit\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>:100644 100644 5a6e0ca2db884e650af657f600586661caa6d236 fa9cd39e2fe3d84dff6f0026cf6➜\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is the commit which introduced the bug, now we can go and fix it at proper location.\u003C/p>\n\u003Cp>Conclude the bisect\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>git bisect reset\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This will bring back to initial checkout, now you can checkout master and fix the issue.\u003C/p>\n\u003Cp>This is how commits our picked for bisect\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/how-use-git-bisect/05_git_bisect.png\" alt=\"Bisect \">\u003C/p>\n\u003Cp>There are advanced ways to do similar activity, this article considers you are new to git bisect and provide beginners approach. This technique is pretty useful when large number of commits in your branch.\u003C/p>\n\u003Cp>Demo git repo is available here: \u003Ca href=\"https://github.com/ashokdudhade/git-bisect-demo\">https://github.com/ashokdudhade/git-bisect-demo\u003C/a>\u003C/p>",{"headings":188,"localImagePaths":198,"remoteImagePaths":199,"frontmatter":200,"imagePaths":203},[189,192,195],{"depth":51,"slug":190,"text":191},"what-is-git-bisect","What is git bisect?",{"depth":51,"slug":193,"text":194},"why-git-bisect","Why git bisect?",{"depth":51,"slug":196,"text":197},"how-to-use-bisect","How to use bisect?",[],[],{"title":175,"date":201,"kind":36,"draft":37,"path":177,"category":178,"tags":202,"description":181},"2020-07-25T02:13:55.325Z",[178,180],[],"how-use-git-bisect.md"]